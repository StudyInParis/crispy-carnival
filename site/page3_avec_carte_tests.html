<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Visu avec carte</title>
  <script src="assets/js/jquery.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
  <link rel="stylesheet" href="assets/css/main_test_gmaps.css" />
  <!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]
  <link rel="stylesheet" href="http://code.leafletjs.com/leaflet-0.3.1/leaflet.css" />
  [if lte IE 8]>
      <link rel="stylesheet" href="http://code.leafletjs.com/leaflet-0.3.1/leaflet.ie.css" />
  <![endif]
  <script src="http://code.leafletjs.com/leaflet-0.3.1/leaflet.js"></script>-->
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
  <script type="text/javascript" src="assets/gmaps/gmaps.js"></script>
  <link rel="stylesheet" href="http://twitter.github.com/bootstrap/1.3.0/bootstrap.min.css" />
  <!--<link rel="stylesheet" type="text/css" href="assets/gmaps/examples.css" />-->
<!-- <script type="text/javascript" src="assets/js/map.js"></script> -->
  <script type="text/javascript">
    var map;
    $(document).ready(function(){
      map = new GMaps({
        el: '#map',
        lat: 48.866667,
        lng: 2.333333,
        zoomControl : true,
        zoomControlOpt: {
            style : 'SMALL',
            position: 'TOP_LEFT'
        },
        panControl : false,
        streetViewControl : false,
        mapTypeControl: false,
        overviewMapControl: false
      });
      jQuery.getJSON('https://raw.githubusercontent.com/StudyInParis/geoapplide/master/donnees_brutes/arrondissements.geojson', function(data) {
          // alert("ok");
          var items = [];
          $.each( data, function( key, val ) {
          if (key == "features"){
            $.each( val, function(value){
              // value = index de l'element dans la liste
              // console.log(val[value]); 
              $.each( val[value], function( key2, val2 ) {
                var color;
                console.log(key2);
                if (key2 == "loyer"){
                  console.log(val2);
                  if (val2=="21"){
                    color="#ff1a1b";
                  }
                  if (val2=="22"){
                    color="#ff0002";
                  }
                  if (val2=="23"){
                    color="#e60001";
                  }
                  if (val2=="24"){
                    color="#cd0001";
                  }
                  if (val2=="25"){
                    color="#b30001";
                  }
                  if (val2=="26"){
                    color="#9a0001";
                  }
                  if (val2=="27"){
                    color="#800001";
                  }
                  if (val2=="28"){
                    color="#670001";
                  }
                }
                if (key2 == "geometry"){
                  $.each( val2, function( key3, val3 ) {
                    if (key3 == "coordinates"){
                      
                      // alert("ok");
                      // console.log([val3][0]);
                      map.drawPolygon({
                      paths: val3,
                      useGeoJSON: true,
                      strokeColor: color,
                      strokeOpacity: 0.6,
                      strokeWeight: 6
                    });
                    }
                  })
                }
              })
            })
          }
        });
      });
      // path = [[[2.351518483670821, 48.8644258050741], [2.350949105218923, 48.86340592861751], [2.346676032763327, 48.864430925901665], [2.346675453051013, 48.86443106483368], [2.345101655171463, 48.864809197959836], [2.341271025930368, 48.86572767724484], [2.34126849090564, 48.86572828653819], [2.341204510696185, 48.865743681005995], [2.341178272058699, 48.86574963323163], [2.341083555178273, 48.86577201721946], [2.337371969067098, 48.86664907439458], [2.335869691238243, 48.86699647535598], [2.335869054057415, 48.86699662650754], [2.333675321300195, 48.867516125009374], [2.33172601351949, 48.867954816599685], [2.331725629348361, 48.86795490259037], [2.330656733960091, 48.86819218066118], [2.330306795320876, 48.86835619167468], [2.329965588686572, 48.86851416917429], [2.328007329038849, 48.86991742140715], [2.32984034160984, 48.87023196300484], [2.332082346211126, 48.87061659840104], [2.334150445666464, 48.870970071095634], [2.337008699424837, 48.87145858186232], [2.337096350892028, 48.87147459083911], [2.339735558883667, 48.87192782312048], [2.339898092256945, 48.87195573212607], [2.34004423190851, 48.87198082642372], [2.343068934219441, 48.87148887381476], [2.347880282483183, 48.87070414850945], [2.350960685471093, 48.870049489007904], [2.3526310157278463, 48.86969449880021], [2.354260580416611, 48.869330050725615], [2.352975454399392, 48.867032060091404], [2.352530424441132, 48.86623248929979], [2.351974400952567, 48.86523967487127], [2.351518483670821, 48.8644258050741]]];
      // map.drawPolygon({
      //   paths: path,
      //   useGeoJSON: true,
      //   strokeColor: '#131540',
      //   strokeOpacity: 0.6,
      //   strokeWeight: 6
      // });
      $.ajax({
            type: 'GET',
            url: 'https://raw.githubusercontent.com/StudyInParis/geoapplide/master/xml_formattes_pivot/xml_pivot.xml',
            dataType: 'xml',
            success: function(xml) {
              var compteur=1;
              $(xml).find('element').each(function() {
                // console.log(compteur);
                //alert(String(compteur));
      //           map.addMarker({
      //           lat: $(this).find('latitude').text(),
      //           lng: $(this).find('longitude').text(),
      //           title: 'Marker with InfoWindow',
      //           infoWindow: {
      //             content: '<p>'+$(this).find('nom').text()+'</br>'+$(this).find('adresse').text()+'</br>'+$(this).attr("type")+'</p>'
      //   }
      // });
      compteur+=1;
              });
            }
            });
        
    });
  </script>
</head>
<body class="left-sidebar">
		<div id="page-wrapper">

  			<!-- Header -->
  				<div id="header-wrapper">
  					<header id="header" class="container">

  						<!-- Logo -->
  							<div id="logo">
                  <h1><a href="index.html">geoapplide</a></h1>
  								<span>projet</span>
  							</div>
                <!-- Logo end -->

                <!-- Nav -->
    							<nav id="nav">
    								<ul>
    									<li class="current"><a href="index.html">Bienvenue !</a></li>
    									<li>
    										<a href="#">Dropdown</a>
    										<ul>
    											<li><a href="#">Lorem ipsum dolor</a></li>
    											<li><a href="#">Magna phasellus</a></li>
    											<li>
    												<a href="#">Phasellus consequat</a>
    												<ul>
    													<li><a href="#">Lorem ipsum dolor</a></li>
    													<li><a href="#">Phasellus consequat</a></li>
    													<li><a href="#">Magna phasellus</a></li>
    													<li><a href="#">Etiam dolore nisl</a></li>
    												</ul>
    											</li>
    											<li><a href="#">Veroeros feugiat</a></li>
    										</ul>
    									</li>
    									<li><a href="donnees.html">Données</a></li>
    									<li><a href="page2_graphes.html">Graphes</a></li>
    									<li><a href="page3_visu.html">Visualisation</a></li>
    								</ul>
    							</nav>

  					</header>
  				</div>
          <!-- Header end -->


          <!-- Main -->
    			<div id="main-wrapper">
    					<div class="container">
    						<div class="row 200%">
                  <div class="4u 12u$(medium)">
    								<div id="sidebar">
                      <section>
                        <h3>Sélectionnez un arrondissement</h3>
                        <ul class="style2">
                          <li><a href="#75001">75001</a></li>
                          <li><a href="#75002">75002</a></li>
                          <li><a href="#75003">75003</a></li>
                          <li><a href="#75004">75004</a></li>
                          <li><a href="#75005">75005</a></li>
                          <li><a href="#75006">75006</a></li>
                          <li><a href="#75007">75007</a></li>
                          <li><a href="#75008">75008</a></li>
                          <li><a href="#75009">75009</a></li>
                          <li><a href="#75010">75010</a></li>
                          <li><a href="#75011">75011</a></li>
                          <li><a href="#75012">75012</a></li>
                          <li><a href="#75013">75013</a></li>
                          <li><a href="#75014">75014</a></li>
                          <li><a href="#75015">75015</a></li>
                          <li><a href="#75016">75016</a></li>
                          <li><a href="#75017">75017</a></li>
                          <li><a href="#75018">75018</a></li>
                          <li><a href="#75019">75019</a></li>
                          <li><a href="#75020">75020</a></li>
                        </ul>
                      </section>
                    </div>
                    <!-- Sidebar end -->
                  </div>
                  <!-- 4u 12u$(medium) end -->

    							<div class="8u 12u$(medium) important(medium)">
    								<div id="content">

    									<!-- Content -->
    										<article>

    											<h2 id="titre">Test</h2>


                          <div id="map"></div>

    										</article>

    								</div>
                    <!-- Content end -->
    							</div>
                  <!-- 8u 12u$(medium) important medium end -->

    			</div>
          <!-- row 200% end -->
    		</div>
        <!-- container end -->
    	</div> <!-- main-wrapper end -->
    </div>
    <!-- page-wrapper end -->

<!-- <textarea id="source" style="width:650px;height:450px;" >
</textarea> -->

<!--<script>
//myXML= document.all("https://raw.githubusercontent.com/StudyInParis/geoapplide/master/xml_formattes_pivot/xml_pivot.xml").XMLDocument;
myXML= document.all("../../xml_formattes_pivot/xml_pivot.xml").XMLDocument;
alert(myXML);

// function myFunction(xml) {
//     var xmlDoc = xml.responseXML;
//     alert(xmlDoc.getElementsByTagName("title")[0].childNodes[0].nodeValue);
// }
</script>-->
</body>
</html>
